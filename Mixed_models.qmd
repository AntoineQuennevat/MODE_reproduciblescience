---
title: "Mixed models in ecology"
bibliography: references.bib
execute: 
  freeze: auto
output: 
  html_document:
   toc: true
   toc_float: true
---



## Introduction : Louis




## Model: cr√©ation du model : Abdou



## Calcule matriciel : Antoine

$$
  M_{2\times2} = \left( {\begin{array}{cc}
    A & B \\
    C & D \\
  \end{array} } \right)
$$


## Structure de dependance : Odin

### Cas des Mesures r√©p√©t√©es

On consid√®re cette fois une exp√©rience visant √† √©valuer l'effet d'un r√©gime sur la prise de poids d'un animal au cours du temps. Plusieurs animaux (indic√©s par $j$) re√ßoivent chaque r√©gime (not√© $i$) et un animal ne re√ßoit qu'un r√©gime au cours de l'exp√©rience. On mesure le poids, not√© $Y_{ij}$, de chaque animal au bout de t semaines ($t = 1, . . . , T$). On parle donc de mesures r√©p√©t√©es, au cours du temps sur un m√™me individu. De telles mesures sont aussi fr√©quemment appel√©es donn√©es *longitudinales*.
Pour analyser ces r√©sultats, on veut tenir compte du fait que les mesures faites au
cours du temps sur un m√™me animal ne sont pas ind√©pendantes. A cette fin, on pourrait
utiliser le mod√®le :

$$E(Y_{ijt}) = ¬µ + Œ±_i + Œ≥_t + (Œ±Œ≥)_{it}$$

avec 

$$Cov(Y_{ijt}, Y_{i'j't'}) = \left\{ 
  \begin{array}{ll}
  œÉ^2œÅ \ \ si \ \ (i, j) = (i_0, j_0) \\
     0 \ sinon \
   \end{array}
  \right.$$

Dans ce mod√®le, la covariance entre deux mesures faites aux temps t et t' sur un m√™me mod√®le est constante, quel que soit l'intervalle de temps qui s√©pare les deux mesures.

**Mod√®le** On propose ici un mod√®le qui prend en compte l'aspect cin√©tique de l'exp√©rience et pr√©voit que la d√©pendance entre deux mesures d√©pend de l'intervalle de temps qui les s√©pare. Une telle d√©pendance n'admet pas de repr√©sentation simple sous la forme d'un eet al√©atoire. On suppose donc que les poids sont gaussiens d'esp√©rances
respectives.

$$ E(Y_{ijt}) = ¬µ + Œ±_i + Œ≥_t + (Œ±Œ≥)_{it} $$ 
**Structure de d√©pendance** On suppose de plus que toutes les mesures ont la m√™me
variance

$$ V(Y_{ijt} =  œÉ^2) $$
et que la covariance entre elles vaut

$$Cov(Y_{ijt}, Y_{i'j't'}) = \left\{ 
  \begin{array}{ll}
  œÉ^2œÅ^{|t-t'|} \ \ si \ \ (i, j) = (i', j') \\
     0 \ sinon \
   \end{array}
  \right.$$
Cette structure suppose que les mesures faites sur des animaux di√©rents sont ind√©pendantes. On suppose de plus que |œÅ| < 1, ce qui implique que celles faites sur un m√™me animal sont d'autant moins corr√©l√©es que l'intervalle de temps est grand. Cette forme de covariance correspond √† un processus auto-r√©gressif d'ordre 1, g√©n√©ralement not√© AR(1).
Ce mod√®le comporte deux param√®tres de variance (aussi appel√©s composantes de la variance) : la corr√©lation temporelle œÅ et la variance de chaque observation œÉ
2, soit

$$
  œà = \left( {\begin{array}{cc}
    œÅ \\
    œÉ^2 \\
  \end{array} } \right)
$$
*Ecriture matricielle* Du fait de l'ind√©pendance entre les mesures obtenues sur des
animaux diff√©rents, la matrice de variance Œ£ a aussi une m√™me forme diagonale par blocs  mais le bloc R diff√®re :

$$
  R = \left( {\begin{array}{cc}
     œÉ^2 & œÉ^2œÅ & œÉ^2œÅ^2 & ... & œÉ^2œÅ^{T-1}\\
     œÉ^2œÅ & ... & ... & ... & ...\\
     œÉ^2œÅ^2 & ... & œÉ^2 & ... & œÉ^2œÅ^2\\
     ... & ... & ... & ... & œÉ^2œÅ\\
    œÉ^2œÅ^{T-1} & ... & œÉ^2œÅ^2 & œÉ^2œÅ & œÉ^2\\
  \end{array} } \right)
$$
```{r}
o.ar1 = gls(Strength ~ Program * Timef, data = d,correlation = corAR1(form = ~ 1 | Subj))
 

```



```{r}
data.spatialCor.glsExp <- gls(y ~ x, data = data.spatialCor,
    correlation = corExp(form = ~LAT + LONG, nugget = TRUE),
    method = "REML")
```




## Application : Ael
### Exploration des donn√©es
### Cr√©ation du model
### Validation
### Interpretation



This chapter is a simple example using R

You can import R package using the code

```{r}
library(tidyverse)
```


and then describe the purpose of your chapter as well as executing R command.


For example a basic summary of a dataset is given by 

```{r}
df <- read.table("https://gist.githubusercontent.com/slopp/ce3b90b9168f2f921784de84fa445651/raw/4ecf3041f0ed4913e7c230758733948bc561f434/penguins.csv", sep = "," , header = TRUE)
```

and produce a graph

```{r}
df %>% ggplot() +
	aes(x=species, y = body_mass_g) +
	geom_boxplot()  
```


A citation @bauer2023writing